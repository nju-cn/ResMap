from typing import List

from matplotlib import pyplot as plt
import numpy as np


plt.rcParams['font.sans-serif'] = ['SimHei']  # 用来正常显示中文标签
plt.rcParams['axes.unicode_minus'] = False  # 用来正常显示负号
lg = {'size': 16}


def show_latency(lb_ltc: List[float], lb_avg: List[float], my_ltc: List[float], my_avg: List[float]):
    lb_ltc, lb_avg = np.array(lb_ltc), np.array(lb_avg)
    my_ltc, my_avg = np.array(my_ltc), np.array(my_avg)
    print(f"单帧时延最大提升 {np.max((lb_ltc-my_ltc)/lb_ltc)*100}%")
    print(f"时延均值平均提升 {np.average((lb_ltc-my_ltc)/lb_ltc)*100}%")

    plt.tick_params(labelsize=13)
    plt.gca().set_xlabel('帧号', fontproperties=lg)
    plt.gca().set_ylabel('时延(s)', fontproperties=lg)
    plt.plot(my_ltc, '-', c='tab:blue', label='DA单帧')
    plt.plot(my_avg, '--', c='tab:blue', label='DA均值')
    plt.plot(lb_ltc, '-', c='tab:orange', label='LB单帧')
    plt.plot(lb_avg, '--', c='tab:orange', label='LB均值')
    plt.gca().set_ylim(1, 11)
    plt.legend(ncol=2, prop=lg)
    plt.tight_layout()


# 数据来源：
# 设备配置：pi4G(m) → 4MB/s(实际带宽3) → pi2G(w0) → 4MB/s(实际带宽3) → pi2G1(w1)
# 运行配置：ax.road[ifr_num=50, gp_size=3]
if __name__ == '__main__':
    # pd_num=1
    print("pd_num=1:")
    p1ltc_lb = [4.038853168487549, 3.915499210357666, 3.9784176349639893, 3.9105372428894043, 3.911146402359009, 4.00354528427124, 3.9953136444091797, 3.955702781677246, 3.940474271774292, 3.896298408508301, 3.9647629261016846, 3.9307947158813477, 3.977017641067505, 3.942357301712036, 3.965573310852051, 3.9145638942718506, 3.972477436065674, 3.947597026824951, 3.9493565559387207, 3.9368841648101807, 3.9525609016418457, 3.949044942855835, 3.873842477798462, 3.9004247188568115, 3.893258571624756, 3.9364824295043945, 3.9896206855773926, 3.9770877361297607, 3.9533491134643555, 4.11541748046875, 3.9168336391448975, 3.974416494369507, 3.922391176223755, 3.9639968872070312, 4.008809804916382, 3.954373359680176, 3.897251844406128, 3.9485607147216797, 3.9193639755249023, 3.9135167598724365, 3.9078242778778076, 3.9034321308135986, 4.005882501602173, 3.9968271255493164, 3.9666290283203125, 3.933432102203369, 3.870321273803711, 3.924372673034668, 3.9099206924438477, 4.0349438190460205]
    p1avg_lb = [4.03886342048645, 3.9782776832580566, 3.978791872660319, 3.9623953104019165, 3.9525686740875243, 3.9614752928415933, 3.966641426086426, 3.965464174747467, 3.96284818649292, 3.956346368789673, 3.9572494246742944, 3.9551875988642373, 3.9570063077486477, 3.956120099340166, 3.95687092145284, 3.954343095421791, 3.955516071880565, 3.955162035094367, 3.9549702845121684, 3.954183876514435, 3.9542070570446195, 3.954058896411549, 3.95063797287319, 3.9486057658990226, 3.9464494228363036, 3.9461222978738637, 3.9477874879483825, 3.948965472834451, 3.949170581225691, 3.954756514231364, 3.9535819638159966, 3.954277090728283, 3.95335561578924, 3.9537129402160645, 3.9553261484418596, 3.9553403788142734, 3.9538098348153605, 3.953710995222393, 3.9528682843232765, 3.9519356966018675, 3.950893628888014, 3.949796580132984, 3.951133140297823, 3.9522030570290307, 3.952553711997138, 3.9521703720092773, 3.9504725172164594, 3.949959988395373, 3.9491743068305816, 3.950930414199829]
    p1ltc_my = [3.2890031337738037, 2.322774887084961, 2.2876741886138916, 2.3778181076049805, 2.442857265472412, 2.568530797958374, 3.2305335998535156, 3.254810333251953, 2.250483989715576, 2.2940149307250977, 3.1714096069335938, 2.2502353191375732, 3.2521023750305176, 2.3371658325195312, 2.379140853881836, 2.397677421569824, 2.5440096855163574, 2.3009426593780518, 2.295525550842285, 2.5102338790893555, 2.7575037479400635, 2.8617186546325684, 3.2815651893615723, 2.3163416385650635, 3.261460304260254, 2.3498499393463135, 2.2857556343078613, 2.3116295337677, 2.6096930503845215, 2.379009246826172, 2.343539237976074, 2.5624256134033203, 2.314434289932251, 2.2989981174468994, 2.603391170501709, 2.6115779876708984, 3.291877031326294, 2.217897653579712, 2.2906436920166016, 2.3127074241638184, 2.709601402282715, 2.3580732345581055, 2.3497276306152344, 3.148228168487549, 2.220062017440796, 2.392838954925537, 2.425808906555176, 2.3306241035461426, 3.2677056789398193, 2.2994582653045654]
    p1avg_my = [3.2890121936798096, 2.806888461112976, 2.6343371073404946, 2.570714235305786, 2.5455603122711183, 2.5497713883717856, 2.647244385310582, 2.7234338521957397, 2.671096271938748, 2.6335429668426515, 2.682575139132413, 2.647005339463552, 2.6936678336216855, 2.6683104038238525, 2.6491302331288655, 2.633506864309311, 2.628329361186308, 2.610224617852105, 2.5937395346792123, 2.5896386742591857, 2.597709065391904, 2.6098791685971348, 2.6391597416089927, 2.625781536102295, 2.6512898349761964, 2.639827544872577, 2.62677553847984, 2.615583266530718, 2.6154310621064285, 2.607614843050639, 2.5991596021959857, 2.5980667918920517, 2.5895303812893955, 2.5810374792884376, 2.5817008359091624, 2.58257481124666, 2.6018063442127124, 2.591748877575523, 2.5840708964910264, 2.577324229478836, 2.5806037274802605, 2.57534274600801, 2.5701423633930296, 2.583315681327473, 2.575276533762614, 2.571343789929929, 2.568280189595324, 2.5633614460627236, 2.577766700666778, 2.572236375808716]
    show_latency(p1ltc_lb, p1avg_lb, p1ltc_my, p1avg_my)

    # pd_num=3
    print("pd_num=3:")
    p3ltc_lb = [4.786261558532715, 5.8222815990448, 6.960336446762085, 4.856046199798584, 4.956571340560913, 4.990305423736572, 4.9083640575408936, 4.840731620788574, 4.874310255050659, 4.67769980430603, 4.6728222370147705, 4.750513076782227, 4.8280861377716064, 4.828605651855469, 4.710536479949951, 4.718026161193848, 4.756572484970093, 4.683918237686157, 4.99401593208313, 4.939972400665283, 4.9721949100494385, 4.856495380401611, 4.8132569789886475, 4.709017992019653, 4.876900911331177, 4.948244571685791, 5.056963205337524, 4.932087659835815, 4.887036561965942, 4.833484649658203, 4.967701435089111, 5.092220067977905, 5.065297842025757, 4.9483795166015625, 4.799597263336182, 4.900592803955078, 4.958624601364136, 4.947467803955078, 4.874657154083252, 4.834954500198364, 4.915255069732666, 5.127093553543091, 4.911654472351074, 4.836028575897217, 4.657893657684326, 4.959989070892334, 5.044149875640869, 4.986521244049072, 4.839910984039307, 4.717535018920898]
    p3avg_lb = [4.786270618438721, 2.9951350688934326, 2.4214088916778564, 2.4253764748573303, 2.189779853820801, 2.042790691057841, 2.087336608341762, 1.9821535348892212, 1.9036188125610352, 1.9290928602218629, 1.8665313937447288, 1.8237432638804119, 1.8554353163792536, 1.811561005456107, 1.7775537490844726, 1.802512064576149, 1.7717848665574019, 1.7416177458233304, 1.7808408611699154, 1.7530954837799073, 1.7296570596240817, 1.758827025240118, 1.7337856603705364, 1.7097355524698894, 1.7429339504241943, 1.7241062842882597, 1.7071206481368453, 1.732413913522448, 1.7143370858554183, 1.6975744406382243, 1.7250699920039023, 1.7127976194024086, 1.696789719841697, 1.718441787888022, 1.7031648227146694, 1.6916076011127896, 1.7131730221413277, 1.6989383258317645, 1.6865148972242305, 1.7055997133255005, 1.6945515551218173, 1.6881702513921828, 1.7008605391480203, 1.6889578049833125, 1.6791734218597412, 1.6977872019228728, 1.6885286239867514, 1.6781495412190754, 1.6926396525636012, 1.6816210269927978]
    p3ltc_my = [4.05704140663147, 5.001888751983643, 6.261968374252319, 3.331404447555542, 3.7262532711029053, 3.4089043140411377, 3.7048656940460205, 3.8344154357910156, 4.0288920402526855, 3.836839199066162, 3.8541359901428223, 3.635004997253418, 3.843379259109497, 3.417623996734619, 3.7809698581695557, 3.240809202194214, 3.4873671531677246, 3.1345467567443848, 3.3549108505249023, 3.3741812705993652, 3.4264729022979736, 3.592939853668213, 4.100548028945923, 4.024808645248413, 3.9508814811706543, 3.1751320362091064, 3.4132282733917236, 3.581981897354126, 3.5983262062072754, 3.67535138130188, 3.3168692588806152, 3.450223207473755, 3.242100477218628, 3.4361042976379395, 3.413740396499634, 3.481414556503296, 3.785691738128662, 3.6986136436462402, 3.880495309829712, 3.550795316696167, 3.510852336883545, 3.7082650661468506, 3.4150662422180176, 3.7534728050231934, 3.4262521266937256, 3.6499269008636475, 3.502599000930786, 3.47599196434021, 3.702509880065918, 3.4912798404693604]
    p3avg_my = [4.05705189704895, 2.501808285713196, 2.088226238886515, 1.8474619388580322, 1.746208095550537, 1.6124647458394368, 1.5850609370640345, 1.5708796679973602, 1.5230318440331354, 1.4933843612670898, 1.4929721355438232, 1.4453062812487285, 1.4444675995753362, 1.4172723633902413, 1.4084068457285563, 1.3762256503105164, 1.372391658670762, 1.3478953970803156, 1.3355838499571149, 1.3353190541267395, 1.3185888131459553, 1.316846576603976, 1.3394953064296558, 1.3215311368306477, 1.3169234943389894, 1.3071276407975416, 1.3011683093176947, 1.3037786483764648, 1.2960394662002037, 1.2936136960983275, 1.2846782668944328, 1.2824234142899513, 1.2743110367746064, 1.2724106802659876, 1.270096697126116, 1.26486912700865, 1.271581205161842, 1.2672171780937596, 1.267129231721927, 1.2650069415569305, 1.2601657378964308, 1.2649510701497395, 1.2561924235765325, 1.259601972319863, 1.2568058172861736, 1.253634442453799, 1.2537689107529661, 1.2507182508707047, 1.252496052761467, 1.2483831882476806]
    plt.figure()
    show_latency(p3ltc_lb, p3avg_lb, p3ltc_my, p3avg_my)

    # pd_num=6
    print("pd_num=6:")
    p6ltc_lb = [4.82288932800293, 6.004542112350464, 7.228421926498413, 8.426594734191895, 9.662330150604248, 10.987264156341553, 8.317591667175293, 8.29173493385315, 8.340659618377686, 8.28456974029541, 8.2861328125, 8.374102592468262, 8.444041728973389, 8.526225805282593, 8.688915014266968, 8.90980577468872, 8.977296590805054, 8.77534008026123, 8.775488376617432, 8.808629035949707, 8.556262493133545, 8.319825172424316, 8.286192655563354, 8.35884404182434, 8.300535678863525, 8.48636531829834, 8.63257122039795, 8.638738632202148, 8.577716827392578, 8.831819295883179, 8.59686827659607, 8.507702589035034, 8.462507963180542, 8.621634244918823, 8.738494873046875, 8.373754024505615, 8.573064088821411, 8.481884717941284, 8.481877326965332, 8.441450595855713, 8.314927101135254, 8.377465724945068, 8.61679482460022, 8.477571249008179, 8.44596552848816, 8.526078939437866, 8.569299697875977, 8.6136953830719, 8.410275936126709, 8.33045744895935]
    p6avg_lb = [4.822899341583252, 3.0883737802505493, 2.517413854598999, 2.223385453224182, 2.054148483276367, 1.956088383992513, 1.8776909964425224, 1.8087473511695862, 1.7661099698808458, 1.7180140256881713, 1.6872770569541238, 1.675968587398529, 1.660693040260902, 1.6426294871738978, 1.638995393117269, 1.6306795328855515, 1.6198862440445845, 1.6048671669430203, 1.5981716733229787, 1.59030442237854, 1.5781850247156053, 1.5641622760079124, 1.5576429056084675, 1.5519706110159557, 1.5466684246063231, 1.549745385463421, 1.5472286807166205, 1.5375358206885201, 1.531186999945805, 1.5359993616739909, 1.5246808528900146, 1.525060497224331, 1.5223773537260112, 1.519812689108007, 1.5183969565800257, 1.5126264757580228, 1.509165602761346, 1.5074913313514309, 1.505667772048559, 1.5028937339782715, 1.4990130575691782, 1.4960231553940546, 1.4989927036817683, 1.494612910530784, 1.4926181422339546, 1.4922295653301736, 1.4899914670497814, 1.4884982804457347, 1.4870997983582166, 1.4818865489959716]
    p6ltc_my = [3.5274691581726074, 4.667366027832031, 5.849313735961914, 6.318916320800781, 7.384417772293091, 8.371943950653076, 6.394896984100342, 6.5259480476379395, 6.447328329086304, 6.343261003494263, 6.370584011077881, 6.504204750061035, 6.419379472732544, 6.092080354690552, 6.353308916091919, 6.285302400588989, 6.336871385574341, 6.312177658081055, 6.554102182388306, 6.446082353591919, 6.24319863319397, 6.442186594009399, 6.306842565536499, 6.1844093799591064, 6.080895900726318, 6.211743593215942, 6.159480571746826, 5.971521377563477, 6.070272207260132, 6.052670955657959, 6.191030502319336, 6.179265737533569, 6.064193964004517, 6.545398235321045, 6.151921987533569, 6.451910734176636, 6.348672389984131, 6.484976291656494, 6.674726247787476, 6.395415782928467, 6.620257377624512, 6.625135183334351, 6.523777723312378, 6.446258783340454, 6.4146294593811035, 6.417489528656006, 6.364212274551392, 6.291529178619385, 6.31507134437561, 6.068163156509399]
    p6avg_my = [3.5274789333343506, 2.334991216659546, 1.9509788354237874, 1.7189470529556274, 1.5884279251098632, 1.4883874257405598, 1.4176972934177943, 1.3997367322444916, 1.3668452633751764, 1.321987771987915, 1.301352154124867, 1.2863545020421345, 1.2573798986581655, 1.235097851072039, 1.2437917073567708, 1.2191251367330551, 1.2148892458747416, 1.2084307935502794, 1.205377691670468, 1.1870254874229431, 1.1857896191733224, 1.1794935356486926, 1.172315027402795, 1.1640730301539104, 1.1593811988830567, 1.1520729340039766, 1.1504390592928286, 1.140067722116198, 1.1391549932545628, 1.1330921252568562, 1.134718833431121, 1.1292197927832603, 1.1250892335718328, 1.1314186208388384, 1.1196837970188687, 1.123505221472846, 1.1223185706782985, 1.121617085055301, 1.123163804029807, 1.1216277658939362, 1.1173142514577725, 1.1207821596236456, 1.1175209311551826, 1.1152264530008489, 1.1159830994076199, 1.114861768224965, 1.1101051442166592, 1.111788218220075, 1.1096140900436713, 1.1028106021881103]
    plt.figure()
    show_latency(p6ltc_lb, p6avg_lb, p6ltc_my, p6avg_my)
    plt.show()
